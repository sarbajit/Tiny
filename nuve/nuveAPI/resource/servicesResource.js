"use strict";var serviceRegistry=require("./../mdb/serviceRegistry"),logger=require("./../logger").logger,cipher=require("../../../common/cipher"),log=logger.getLogger("ServicesResource"),currentService,doInit=function(){currentService=require("./../auth/nuveAuthenticator").service;var e=require("./../mdb/dataBase").superService;return currentService._id=currentService._id+"",currentService._id===e};exports.create=function(e,r){if(!doInit())return log.info("Service ",currentService._id," not authorized for this action"),void r.status(401).send("Service not authorized for this action");var i=e.body;i.encrypted=!0,i.key=cipher.encrypt(cipher.k,i.key),serviceRegistry.addService(i,function(e){log.info("Service created: ",i.name),r.send(e)})},exports.represent=function(e,r){return doInit()?void serviceRegistry.getList(function(e){log.info("Representing services"),r.send(e)}):(log.info("Service ",currentService," not authorized for this action"),void r.status(401).send("Service not authorized for this action"))};