var db=require("./dataBase").db,logger=require("./../logger").logger,log=logger.getLogger("ServiceRegistry");exports.getList=function(e){"use strict";db.services.find({}).toArray(function(r,o){r||!o?log.info("Empty list"):e(o)})};var getService=exports.getService=function(e,r){"use strict";var o;try{o=db.ObjectId(e)}catch(i){return void("function"==typeof r&&r(void 0))}db.services.findOne({_id:o},function(e,o){(void 0===o||null===o)&&log.info("Service not found"),"function"==typeof r&&r(o)})},hasService=exports.hasService=function(e,r){"use strict";getService(e,function(e){r(void 0===e?!1:!0)})};exports.addService=function(e,r){"use strict";e.rooms=[],db.services.save(e,function(e,o){e&&log.info("MongoDB: Error adding service: ",e),r(o._id+"")})},exports.updateService=function(e){"use strict";db.services.save(e,function(e,r){e&&log.info("MongoDB: Error updating service: ",e)})},exports.removeService=function(e){"use strict";hasService(e,function(r){r&&db.services.remove({_id:db.ObjectId(e)},function(e,r){e&&log.info("MongoDB: Error removing service: ",e)})})},exports.getRoomForService=function(e,r,o){"use strict";var i;for(i in r.rooms)if(r.rooms.hasOwnProperty(i)&&String(r.rooms[i]._id)===String(e))return void o(r.rooms[i]);o(void 0)};